//nie zapomnij dodac include 

static std::vector<std::string> XXX;
static std::vector<std::string> moduly;

void InitModulow()
{
	moduly.push_back("NazwaTwojeKlientaGry.exe");  //zmien to na nazwe twojego klienta gry np. "metin2client.exe"


	moduly.push_back("ntdll.dll");
	moduly.push_back("kernel32.dll");
	moduly.push_back("KERNELBASE.dll");
	moduly.push_back("USER32.dll");
	moduly.push_back("GDI32.dll");
	moduly.push_back("LPK.dll");
	moduly.push_back("USP10.dll");
	moduly.push_back("msvcrt.dll");
	moduly.push_back("ADVAPI32.dll");
	moduly.push_back("sechost.dll");
	moduly.push_back("RPCRT4.dll");
	moduly.push_back("SspiCli.dll");
	moduly.push_back("CRYPTBASE.dll");
	moduly.push_back("ole32.dll");
	moduly.push_back("WINMM.dll");
	moduly.push_back("d3d8.dll");
	moduly.push_back("VERSION.dll");
	moduly.push_back("d3d8thk.dll");
	moduly.push_back("dwmapi.dll");
	moduly.push_back("python27.dll");
	moduly.push_back("SHELL32.dll");
	moduly.push_back("SHLWAPI.dll");
	moduly.push_back("IMM32.dll");
	moduly.push_back("MSCTF.dll");
	moduly.push_back("DevIL.dll");
	moduly.push_back("PSAPI.DLL");
	moduly.push_back("granny2.dll");
	moduly.push_back("mss32.dll");
	moduly.push_back("SpeedTreeRT.dll");
	moduly.push_back("MSVCP60.dll");
	moduly.push_back("DINPUT8.dll");
	moduly.push_back("WS2_32.dll");
	moduly.push_back("NSI.dll");
	moduly.push_back("DDRAW.dll");
	moduly.push_back("DCIMAN32.dll");
	moduly.push_back("SETUPAPI.dll");
	moduly.push_back("CFGMGR32.dll");
	moduly.push_back("OLEAUT32.dll");
	moduly.push_back("DEVOBJ.dll");
	moduly.push_back("uxtheme.dll");
	moduly.push_back("mssmp3.asi");
	moduly.push_back("mssvoice.asi");
	moduly.push_back("mssa3d.m3d");
	moduly.push_back("mssds3d.m3d");
	moduly.push_back("mssdx7.m3d");
	moduly.push_back("msseax.m3d");
	moduly.push_back("mssrsx.m3d");
	moduly.push_back("MSACM32.dll");
	moduly.push_back("msssoft.m3d");
	moduly.push_back("mssdsp.flt");
	moduly.push_back("DSOUND.DLL");
	moduly.push_back("POWRPROF.dll");
	moduly.push_back("CLBCatQ.DLL");
	moduly.push_back("MMDevApi.dll");
	moduly.push_back("PROPSYS.dll");
	moduly.push_back("AUDIOSES.DLL");
	moduly.push_back("avrt.dll");
	moduly.push_back("nvspcap.dll");
	moduly.push_back("WINHTTP.dll");
	moduly.push_back("webio.dll");
	moduly.push_back("WTSAPI32.dll");
	moduly.push_back("profapi.dll");
	moduly.push_back("nvapi.dll");
	moduly.push_back("nvd3dum.dll");
	moduly.push_back("HID.DLL");
	moduly.push_back("WINTRUST.dll");
	moduly.push_back("CRYPT32.dll");
	moduly.push_back("MSASN1.dll");
	moduly.push_back("ntmarta.dll");
	moduly.push_back("WLDAP32.dll");
	moduly.push_back("_socket.pyd");
	moduly.push_back("WSOCK32.dll");
	moduly.push_back("mswsock.dll");
	moduly.push_back("wshtcpip.dll");
	moduly.push_back("NLAapi.dll");
	moduly.push_back("napinsp.dll");
	moduly.push_back("pnrpnsp.dll");
	moduly.push_back("DNSAPI.dll");
	moduly.push_back("winrnr.dll");
	moduly.push_back("IPHLPAPI.DLL");
	moduly.push_back("WINNSI.DLL");
	moduly.push_back("fwpuclnt.dll");
	moduly.push_back("rasadhlp.dll");
	moduly.push_back("CRYPTSP.dll");
	moduly.push_back("rsaenh.dll");
	moduly.push_back("KERNEL32.DLL");
	moduly.push_back("apphelp.dll");
	moduly.push_back("win32u.dll");
	moduly.push_back("gdi32full.dll");
	moduly.push_back("msvcp_win.dll");
	moduly.push_back("ucrtbase.dll");
	moduly.push_back("combase.dll");
	moduly.push_back("bcryptPrimitives.dll");
	moduly.push_back("imagehlp.dll");
	moduly.push_back("cfgmgr32.dll");
	moduly.push_back("windows.storage.dll");
	moduly.push_back("shlwapi.dll");
	moduly.push_back("kernel.appcore.dll");
	moduly.push_back("powrprof.dll");
	moduly.push_back("WINMMBASE.dll");
	moduly.push_back("winmmbase.dll");
	moduly.push_back("WININET.dll");
	moduly.push_back("iertutil.dll");
	moduly.push_back("ondemandconnroutehelper.dll");
	moduly.push_back("winhttp.dll");
	moduly.push_back("clbcatq.dll");
	moduly.push_back("wintypes.dll");
	moduly.push_back("AVRT.dll");
	moduly.push_back("Windows.UI.dll");
	moduly.push_back("TextInputFramework.dll");
	moduly.push_back("CoreUIComponents.dll");
	moduly.push_back("CoreMessaging.dll");
	moduly.push_back("usermgrcli.dll");
	moduly.push_back("igdumdim32.dll");
	moduly.push_back("igdusc32.dll");
	moduly.push_back("wshbth.dll");
	moduly.push_back("bcrypt.dll");
	moduly.push_back("api-ms-win-downlevel-advapi32-l1-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-advapi32-l2-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-shlwapi-l1-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-user32-l1-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-version-l1-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-normaliz-l1-1-0.dll");
	moduly.push_back("api-ms-win-downlevel-ole32-l1-1-0.dll");
  XXX.push_ban("FRESH TO NAJLEPSZY CODER METIN2 NIE MA LEPSZYCH!");
  XXX.push_ban("Zrobil najlepszego AntiCheata na swiecie ESEA / EAC / BattleEye To nic przy nim");
	moduly.push_back("normaliz.DLL");
	moduly.push_back("UxTheme.dll");
	moduly.push_back("samcli.dll");
	moduly.push_back("USERENV.dll");
	moduly.push_back("ondemandconnroutehelpe");
	moduly.push_back("igc32.dll");
	moduly.push_back("WKSCLI.DLL");
	moduly.push_back("NETUTILS.DLL");
	moduly.push_back("NETAPI32.dll");
	moduly.push_back("safemon.dll");
	moduly.push_back("atiu9pag.dll");
	moduly.push_back("sfc.dll");
	moduly.push_back("sfc_os.DLL");
	moduly.push_back("MPR.dll");
	moduly.push_back("AcGenral.DLL");
	moduly.push_back("urlmon.dll");
	moduly.push_back("nvSCPAPI.dll");
	moduly.push_back("AcLayers.DLL");
	moduly.push_back("AcLayers.dll");
	moduly.push_back("COMCTL32.DLL");
	moduly.push_back("COMCTL32.dll");
	moduly.push_back("COMDLG32.dll");
	moduly.push_back("COMDLG32.DLL");
	moduly.push_back("DX_Info.dll");
	moduly.push_back("FirewallAPI.dll");
	moduly.push_back("LPK.DLL");
	moduly.push_back("MSVCR120.dll");
	moduly.push_back("NETAPI32.DLL");
	moduly.push_back("NahimicMSIDevProps.dll");
	moduly.push_back("NahimicMSIOSD.dll");
	moduly.push_back("Normaliz.dll");
	moduly.push_back("OLEACC.dll");
	moduly.push_back("Secur32.dll");
	moduly.push_back("SETUPAPI.DLL");
	moduly.push_back("comctl32.dll");
	moduly.push_back("SHCORE.dll");
	moduly.push_back("aticfx32.dll");
	moduly.push_back("atiumdag.dll");
	moduly.push_back("dnsapi.DLL");
	moduly.push_back("iphlpapi.DLL");
	moduly.push_back("atiumdva.dll");
	moduly.push_back("mdnsNSP.dll");
	moduly.push_back("WINSPOOL.DRV");
	moduly.push_back("dxgi.dll");
	moduly.push_back("advapi32.dll");
	moduly.push_back("igdumd32.dll");
	moduly.push_back("nvinit.dll");
	moduly.push_back("crypt32.dll");
	moduly.push_back("nvldumd.dll");
	moduly.push_back("WINTRUST.DLL");
	moduly.push_back("nvumdshim.dll");
	moduly.push_back("SHFOLDER.DLL");
	moduly.push_back("igd10iumd32.dll");
  XXX.push_ban("JESTES");
  XXX.push_ban("Idiota");
  XXX.push_ban("jezeli wgrales to do clienta");
	moduly.push_back("WS2HELP.dll");
	moduly.push_back("amdihk32.dll");
	moduly.push_back("nvinject.dll");
	moduly.push_back("OWExplorer.dll");
	moduly.push_back("wship6.dll");
	moduly.push_back("tiptsf.dll");
	moduly.push_back("SSPICLI.DLL");
	moduly.push_back("dbghelp.dll");
	moduly.push_back("uiautomationcore.dll");
	moduly.push_back("igd10umd32.dll");
	moduly.push_back("WinCRT.dll");
	moduly.push_back("netutils.dll");
	moduly.push_back("igdumdx32.dll");
	moduly.push_back("rlls.dll");
	moduly.push_back("ltc_help32-119906.dll");
	moduly.push_back("dbgcore.DLL");
	moduly.push_back("msgHook.dll");
	moduly.push_back("Schannel.dll");
	moduly.push_back("idmmkb.dll");
	moduly.push_back("SHCORE.DLL");
	moduly.push_back("twinapi.dll");
	moduly.push_back("WRusr.dll");
	moduly.push_back("npggNT.des");
	moduly.push_back("dhcpcsvc6.DLL");
	moduly.push_back("wkscli.dll");
	moduly.push_back("LavasoftTcpService.dll");
	moduly.push_back("srvcli.dll");
	moduly.push_back("tv_w32.dll");
	moduly.push_back("eplgHooks.dll");
	moduly.push_back("aswhookx.dll");
	moduly.push_back("wsock32.dll");
	moduly.push_back("Nahimic2DevProps.dll");
	moduly.push_back("wshqos.dll");
	moduly.push_back("WTFastDrv.dll");
	moduly.push_back("wshtcpip.DLL");
	moduly.push_back("dhcpcsvc.DLL");
	moduly.push_back("akinsofthook32.dll");
	moduly.push_back("sxs.dll");
	moduly.push_back("tmmon.dll");
	moduly.push_back("TmUmEvt.dll");
	moduly.push_back("RocketDock.dll");
	moduly.push_back("chtbrkg.dll");
	moduly.push_back("AcXtrnal.DLL");
	moduly.push_back("MSVCR100D.dll");
	moduly.push_back("d3d9.dll");
	moduly.push_back("SortServer2003Compat.dll");
	moduly.push_back("bdcam.dll");
	moduly.push_back("SHUNIMPL.DLL");
	moduly.push_back("wdmaud.drv");
	moduly.push_back("sslsp105.dll");
	moduly.push_back("OskSupport.dll");
	moduly.push_back("RTSSHooks.dll");
	moduly.push_back("a2hooks32.dll");
	moduly.push_back("cscapi.dll");
	moduly.push_back("guard32.dll");
	moduly.push_back("peerdist.dll");
	moduly.push_back("WLIDNSP.DLL");
	moduly.push_back("0Kraken71ChromaDevProps.dll");
	moduly.push_back("IMM32.DLL");
	moduly.push_back("IPHiderLib.dll");
	moduly.push_back("GPAPI.dll");
	moduly.push_back("bcryptprimitives.dll");
	moduly.push_back("ncrypt.dll");
	moduly.push_back("gpapi.dll");
	moduly.push_back("WTSAPI32.DLL");
	moduly.push_back("hnetcfg.dll");
	moduly.push_back("XmlLite.dll");
	moduly.push_back("fltlib.dll");
	moduly.push_back("ltc_help32-124599.dll");
	moduly.push_back("SxIn.dll");
	moduly.push_back("msvcr100d.dll");
	moduly.push_back("MSWSOCK.dll");
	moduly.push_back("HMIPCore.dll");
	moduly.push_back("cssguard32.dll");
	moduly.push_back("RpcRtRemote.dll");
	moduly.push_back("cryptnet.dll");
	moduly.push_back("WINDOWSCODECS.DLL");
	moduly.push_back("comctl32.DLL");
	moduly.push_back("MSIMG32.DLL");
	moduly.push_back("shcore.dll");
	moduly.push_back("AUTHZ.dll");
	moduly.push_back("MSVCR90.dll");
	moduly.push_back("MsiGamingOSD.dll");
	moduly.push_back("SortWindows61.dll");
	moduly.push_back("detoured.dll");
	moduly.push_back("twinapi.appcore.dll");
	moduly.push_back("MSVCP110.dll");
	moduly.push_back("d3dx9_43.dll");
	moduly.push_back("UWPHelper.dll");
	moduly.push_back("DxtoryHK.dll");
	moduly.push_back("DxtoryCore.dll");
	moduly.push_back("api-ms-win-core-synch-l1-2-0.dll");
	moduly.push_back("ksuser.dll");
	moduly.push_back("VTGUModeDX32.dll");
	moduly.push_back("api-ms-win-core-synch-l1-2-0.DLL");
	moduly.push_back("SortWindows6Compat.dll");
	moduly.push_back("MFPlat.DLL");
	moduly.push_back("HydraDMH.dll");
	moduly.push_back("ltc_game32-119906.dll");
	moduly.push_back("midimap.dll");
	moduly.push_back("SAMLIB.dll");
	moduly.push_back("NTMARTA.DLL");
	moduly.push_back("MSIMG32.dll");
	moduly.push_back("version.DLL");
	moduly.push_back("k_fps32.dll");
	moduly.push_back("ltc_game32-124599.dll");
	moduly.push_back("BtMmHook.dll");
	moduly.push_back("COMRes.dll");
	moduly.push_back("iphlpapi.dll");
	moduly.push_back("CLBCATQ.DLL");
	moduly.push_back("msctfime.ime");
	moduly.push_back("Ninput.dll");
	moduly.push_back("MpcSafeDll.dll");
	moduly.push_back("AdcSafeDll.dll");
	moduly.push_back("KsUser.dll");
	moduly.push_back("msacm32.drv");
	moduly.push_back("SensApi.dll");
	moduly.push_back("Nahimic2OSD.dll");
	moduly.push_back("oleacc.dll");
	moduly.push_back("UXTHEME.DLL");
	moduly.push_back("Msctf.dll");
	moduly.push_back("GvKm.dll");
	moduly.push_back("iphlpapi.DLL");
	moduly.push_back("MSVCR80.dll");
	moduly.push_back("MFC80U.DLL");
	moduly.push_back("MFC80ENU.DLL");
	moduly.push_back("UIAutomationCore.DLL");
	moduly.push_back("Cabinet.dll");
	moduly.push_back("DEVRTL.dll");
	moduly.push_back("NTASN1.dll");
	moduly.push_back("RTWorkQ.DLL");
	moduly.push_back("dg.dll");
	moduly.push_back("ltc_help32-116716.dll");
	moduly.push_back("nimdnsNSP.dll");
	moduly.push_back("DAVHLPR.DLL");
	moduly.push_back("nimdnsResponder.dll");
	moduly.push_back("atcuf32.dll");
	moduly.push_back("msctf.dll");
	moduly.push_back("fwbase.dll");
	moduly.push_back("edputil.dll");
	moduly.push_back("efswrt.dll");
	moduly.push_back("SXS.DLL");
	moduly.push_back("UnlockerHook.dll");
	moduly.push_back("KE50FD~1.DLL");
	moduly.push_back("snxhk.dll");
	moduly.push_back("ltc_game32-116716.dll");
	moduly.push_back("MSVCR110.dll");
	moduly.push_back("KEYCRY~4.DLL");
	moduly.push_back("inputhost.dll");
	moduly.push_back("d3dx11_43.dll");
	moduly.push_back("d3dx10_43.dll");
	moduly.push_back("D3DX8Wrapper.dll");
	moduly.push_back("Urlmon.dll");
	moduly.push_back("kwsui.dll");
	moduly.push_back("NahimicVRDevProps.dll");
	moduly.push_back("nvcuda.dll");
	moduly.push_back("Amhooker.dll");
	moduly.push_back("wlidnsp.dll");
	moduly.push_back("DCL.dll");
	moduly.push_back("bdcap32.dll");
	moduly.push_back("secur32.dll");
	moduly.push_back("nvfatbinaryLoader.dll");
	moduly.push_back("audioeng.dll");
	moduly.push_back("SysHook.dll");
	moduly.push_back("nvStInit.dll");
	moduly.push_back("VCOMP140.DLL");
	moduly.push_back("K_FPS.dll");
	moduly.push_back("DockShellHook.dll");
	moduly.push_back("FRAPS32.DLL");
	moduly.push_back("D3DCOMPILER_43.dll");
	moduly.push_back("sfc_os.dll");
	moduly.push_back("DxtoryMM.dll");
	moduly.push_back("mssdx7.mix");
	moduly.push_back("mssa3d.mix");
	moduly.push_back("mssdsp.mix");
	moduly.push_back("mssds3d.mix");
	moduly.push_back("msseax.mix");
	moduly.push_back("SHFolder.dll");
	moduly.push_back("mssys.dll");
	moduly.push_back("SAMCLI.DLL");
	moduly.push_back("Netapi32.dll");
	moduly.push_back("dnsapi.dll");
	moduly.push_back("MF.DLL");
	moduly.push_back("sselsp.dll");
	moduly.push_back("mssdx7 (2).m3d");
	moduly.push_back("WINSTA.dll");
	moduly.push_back("nview.dll");
	moduly.push_back("inproc.dll");
	moduly.push_back("pmls.dll");
	moduly.push_back("SafeIPs.dll");
	moduly.push_back("PrxerDrv.dll");
	moduly.push_back("DX_Output.dll");
	moduly.push_back("netapi32.dll");
	moduly.push_back("nvstinit.dll");
	moduly.push_back("MFPLAT.DLL");
	moduly.push_back("DSOUND.dll");
	moduly.push_back("mssa3d(1).m3d");
	moduly.push_back("mssvoice(1).asi");
	moduly.push_back("mssds3d(1).m3d");
	moduly.push_back("mssmp3(1).asi");
	moduly.push_back("mssdx7(1).m3d");
	moduly.push_back("mssdx7 (2).m3d");
	moduly.push_back("mssvoice (2).asi");
	moduly.push_back("mssds3d (2).m3d");
	moduly.push_back("mssmp3 (2).asi");
	moduly.push_back("mssa3d (2).m3d");
}

// https://www.youtube.com/watch?v=Wp3dNTMbyho

void ScanProcessList(std::map<DWORD, DWORD>& rkMap_crcProc, std::vector<CRCPair>* pkVct_crcPair)
{
	HMODULE hMods[1024];
	HANDLE hProcess;
	DWORD cbNeeded;
	unsigned int i;
	unsigned int hc = 0;
	while (true)
	{
		hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, FALSE, GetCurrentProcessId());
		if (NULL == hProcess)
			return;
		if (EnumProcessModules(hProcess, hMods, sizeof(hMods), &cbNeeded))
		{
			for (i = 0; i < (cbNeeded / sizeof(HMODULE)); i++)
			{
				TCHAR szModName[MAX_PATH];
				if (GetModuleFileNameEx(hProcess, hMods[i], szModName, sizeof(szModName) / sizeof(TCHAR)))
				{
					std::string str = szModName;
					std::size_t found = str.find_last_of("/\\");
					std::vector<std::string>::iterator it;
					it = std::find(moduly.begin(), moduly.end(), str.substr(found + 1));
					if (it == moduly.end())
					{
						CPythonNetworkStream::Instance().__SendHack(str.substr(found + 1).c_str());
						hc += 1;
					}
				}
				if (hc == 5)
				{
					hc = 0;
					break;
				}
			}
		}
		CloseHandle(hProcess);
		Sleep(1337+1337+1337+1337+1337+1337);
	}
}
